<div class="player-overlay">
  <div class="player-backdrop" (click)="closePlayer.emit()"></div>
  <div class="player-card">
    <div class="player-header">
      <div class="player-title">{{ video.title }}</div>
      <div class="d-flex gap-1">
        <button class="btn btn-sm btn-outline-secondary" (click)="minimizePlayer.emit()" title="Minimize (m)">—</button>
        <button class="btn btn-sm btn-outline-secondary" (click)="closePlayer.emit()" title="Close (Esc)">✕</button>
      </div>
    </div>
    <div class="player-body">
      <youtube-player
        [videoId]="video.id" [id]="'player-' + video.id"
        [playerVars]="{autoplay: 1, rel: 0}"
        (ready)="onPlayerReady($event)"
        (stateChange)="onStateChange($event)">
      </youtube-player>
    </div>
    <div class="player-controls">
      <button class="btn btn-sm btn-outline-secondary" (click)="togglePlayPause()" title="Play/Pause (Space)">
        @if (playerState() === 1 || playerState() === 3) { <!-- Playing or Buffering -->
          <span>⏸️</span>
        } @else {
          <span>▶️</span>
        }
      </button>
      <button class="btn btn-sm btn-outline-secondary" (click)="seekVideo(-15)" title="Seek back 15s (Left arrow)">«</button>
      <button class="btn btn-sm btn-outline-secondary" (click)="seekVideo(15)" title="Seek forward 15s (Right arrow)">»</button>
      <button class="btn btn-sm btn-outline-secondary" [class.active]="currentPlaybackRate() === 0.75" (click)="setPlaybackRate(0.75)" title="0.75x speed (1)">0.75x</button>
      <button class="btn btn-sm btn-outline-secondary" [class.active]="currentPlaybackRate() === 1" (click)="setPlaybackRate(1)" title="1x speed (2)">1x</button>
      <button class="btn btn-sm btn-outline-secondary" [class.active]="currentPlaybackRate() === 1.25" (click)="setPlaybackRate(1.25)" title="1.25x speed (3)">1.25x</button>
      <button class="btn btn-sm btn-outline-secondary" [class.active]="currentPlaybackRate() === 1.5" (click)="setPlaybackRate(1.5)" title="1.5x speed (4)">1.5x</button>
      <button class="btn btn-sm btn-outline-secondary" [class.active]="currentPlaybackRate() === 2" (click)="setPlaybackRate(2)" title="2x speed (5)">2x</button>
    </div>
  </div>
</div>